<div class="product-card-custom">
  <a href="{{ product.url }}" class="product-card-custom-image">
    {{ product | image_url: width: 1200 | image_tag: class: 'custom-class', loading: 'lazy' }}
  </a>
  <div class="product-card-custom-details">
    <h4 class="product-card-custom-title">{{ product.title }}</h4>
    {% if product.variants.size > 1 or product.compare_at_price_max > product.price %}
      <div class="product-card-custom__options">
        {% if product.variants.size > 1 -%}
          <select class="product-card-custom-variants">
            {% for variant in product.variants -%}
              <option
                value="{{ variant.id }}"
                data-image="{{ variant.image | image_url }}"
                data-price="{{ variant.price | money_without_trailing_zeros }}"
                test="{{ variant.compare_at_price }}"
                test-2="{{ variant.price }}"
                {%- if variant.compare_at_price > variant.price -%}
                  data-sale="{{ 100 | minus: variant.price | times: 100.0 | divided_by: variant.compare_at_price | round }}%"
                {%- endif %}
              >
                {{ variant.title }} - {{ variant.price | money }}
              </option>
            {%- endfor %}
          </select>
        {%- endif -%}
        {%- if product.compare_at_price_max > product.price -%}
          <p class="product-card-custom-discount">
            {{ 100 | minus: product.price | times: 100.0 | divided_by: product.compare_at_price_max | round }}%
          </p>
        {%- endif %}
      </div>
    {% endif %}

    <div class="quick-add no-js-hidden">
      {%- liquid
        assign product_form_id = 'quick-add-' | append: section.id | append: product.id
      -%}
      <product-form>
        {%- form 'product',
          product,
          id: product_form_id,
          class: 'form',
          novalidate: 'novalidate',
          data-type: 'add-to-cart-form'
        -%}
          <input
            type="hidden"
            name="id"
            value="{{ product.selected_or_first_available_variant.id }}"
            disabled
          >
          <button
            id="{{ product_form_id }}-submit"
            type="submit"
            name="add"
            class="product-card-custom__button quick-add__submit button"
            aria-haspopup="dialog"
            aria-labelledby="{{ product_form_id }}-submit title-{{ section.id }}-{{ product.id }}"
            aria-live="polite"
            data-sold-out-message="true"
            {% if product.selected_or_first_available_variant.available == false %}
              disabled
            {% endif %}
          >
            <span>
              {%- if product.selected_or_first_available_variant.available -%}
                {{ 'products.product.add_to_cart' | t }} -
                <span class="button-price">{{ product.price | money_without_trailing_zeros }}</span>
              {%- else -%}
                {{ 'products.product.sold_out' | t }}
              {%- endif -%}
            </span>
            <div class="loading-overlay__spinner hidden">
              <svg
                aria-hidden="true"
                focusable="false"
                class="spinner"
                viewBox="0 0 66 66"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
              </svg>
            </div>
          </button>
        {%- endform -%}
      </product-form>
    </div>
  </div>
</div>
